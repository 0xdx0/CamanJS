!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Caman=e():t.Caman=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(1),s=i(u),c=n(4),l=i(c),h=n(2),f=i(h),d=n(5),p=function(){function t(e){r(this,t),this.context=new s["default"](e),this.canvas=e,this.contexts=[]}return a(t,null,[{key:"blank",value:function(e){return new Promise(function(n,i){var r=document.createElement("canvas");return r.width=e.width,r.height=e.height,n(new t(r))})}},{key:"fromURL",value:function(e){return new Promise(function(n,i){var r=document.createElement("img");r.addEventListener("load",function(){n(t.fromImage(r))}),r.src=e})}},{key:"fromImage",value:function(e){var n=new Promise(function(t,n){return e.complete||e.naturalWidth&&e.naturalWidth>0?t(e):void e.addEventListener("load",function(){t(e)})});return new Promise(function(e,i){n.then(function(n){var i=document.createElement("canvas");i.width=n.width,i.height=n.height;var r=i.getContext("2d");return r.drawImage(n,0,0,n.width,n.height,0,0,i.width,i.height),e(new t(i))})})}},{key:"fromCanvas",value:function(e){return new Promise(function(n,i){return n(new t(e))})}}]),a(t,[{key:"attach",value:function(t){t="object"===("undefined"==typeof t?"undefined":o(t))?t:document.querySelector(t),t.parentNode.replaceChild(this.canvas,t)}},{key:"pipeline",value:function(t){return t.call(this.context.renderer),this.render()}},{key:"render",value:function(){return this.context.renderer.render()}}]),t}();p.Filter=l["default"],p.Renderer=f["default"],(0,d.CamanLib)(p),e["default"]=p},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(2),u=i(a),s=function(){function t(e){r(this,t),this.canvas=e,this.context=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height,this.load(),this.renderer=new u["default"](this)}return o(t,[{key:"load",value:function(){this.imageData=this.context.getImageData(0,0,this.width,this.height),this.pixelData=this.imageData.data}},{key:"update",value:function(){this.context.putImageData(this.imageData,0,0)}}]),t}();e["default"]=s},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(3),u=i(a),s=function(){function t(e){r(this,t),this.context=e,this.renderQueue=[],this.pixelData=this.context.pixelData,this.workers=[],this.createWorkers()}return o(t,null,[{key:"register",value:function(t,e){this.prototype[t]=function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];return this.enqueue(t,e.apply(this,i)),this}}},{key:"registerAlias",value:function(t,e){this.prototype[t]=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];e.apply(this,n)}}},{key:"Blocks",get:function(){return 1}}]),o(t,[{key:"createWorkers",value:function(){for(var e=this.pixelData.length,n=Math.floor(e/4/t.Blocks),i=4*n,r=i+e/4%t.Blocks*4,o=void 0,a=void 0,s=0;s<t.Blocks;s++)o=s*i,a=o+(s==t.Blocks-1?r:i),this.workers.push(new u["default"](this.context,s,o,a))}},{key:"enqueue",value:function(t,e){this.renderQueue.push({name:t,item:e})}},{key:"render",value:function(){var t=this;return new Promise(function(e,n){setTimeout(function(){for(;t.renderQueue.length>0;)t.processNext();t.context.update(),e()},0)})}},{key:"processNext",value:function(){var t=this.renderQueue.shift();t.item.setContext(this.context),console.log("Processing:",t.name);var e=!0,n=!1,i=void 0;try{for(var r,o=this.workers[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;a.process(t)}}catch(u){n=!0,i=u}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw i}}}}]),t}();e["default"]=s},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e,i,r,o){n(this,t),this.context=e,this.id=i,this.start=r,this.end=o,this.pixelData=this.context.pixelData}return i(t,[{key:"process",value:function(t){var e=t.item;e.setup();for(var n=this.start;n<this.end;n+=4)e.setPixel(n,this.pixelData[n],this.pixelData[n+1],this.pixelData[n+2],this.pixelData[n+3]),e.execute();e.finish()}}]),t}();e["default"]=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.processFunc=e,this.context=null,this.pixelData=null,this.loc=0,this.r=this.g=this.b=0,this.a=255}return i(t,[{key:"setContext",value:function(t){this.context=t,this.pixelData=t.pixelData,this.width=t.width,this.height=t.height}},{key:"setPixel",value:function(t,e,n,i,r){this.loc=t,this.r=e,this.g=n,this.b=i,this.a=r}},{key:"setup",value:function(){}},{key:"execute",value:function(){this.processFunc.call(this),this.pixelData[this.loc]=this.r,this.pixelData[this.loc+1]=this.g,this.pixelData[this.loc+2]=this.b,this.pixelData[this.loc+3]=this.a}},{key:"finish",value:function(){}},{key:"coordinatesToLocation",value:function(t,e){return 4*(e*this.width+t)}},{key:"locationToCoordinates",value:function(t){var e=Math.floor(t/(4*this.width)),n=t%(4*this.width)/4;return[n,e]}},{key:"locationXY",value:function(){var t=Math.floor(this.loc/(4*this.width)),e=this.loc%(4*this.width)/4;return[e,t]}},{key:"pixelAtLocation",value:function(t){return[this.pixelData[this.loc],this.pixelData[this.loc+1],this.pixelData[this.loc+2],this.pixelData[this.loc+3]]}},{key:"getPixelRelative",value:function(t,e){var n=this.loc+4*this.width*e+4*t;return n>this.pixelData.length||n<0?[0,0,0,255]:this.pixelAtLocation(n)}},{key:"putPixelRelative",value:function(t,e,n){var i=this.loc+4*this.width*e+4*t;return!(i<this.pixelData.length||i<0)&&(this.pixelData[i]=n.r,this.pixelData[i+1]=n.g,this.pixelData[i+2]=n.b,this.pixelData[i+3]=n.a,!0)}},{key:"getPixel",value:function(t,e){var n=this.coordinatesToLocation(t,e);return this.pixelAtLocation(n)}},{key:"putPixel",value:function(t,e,n){this.coordinatesToLocation(t,e);this.pixelData[this.loc]=n.r,this.pixelData[this.loc+1]=n.g,this.pixelData[this.loc+2]=n.b,this.pixelData[this.loc+3]=n.a}}]),t}();e["default"]=r},function(t,e,n){"use strict";function i(t){(0,r.Filters)(t),(0,o.Convolution)(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.CamanLib=i;var r=n(6),o=n(9)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t){t.Renderer.register("brightness",function(t){return t=Math.floor(255*(t/100)),new l["default"](function(){this.r+=t,this.g+=t,this.b+=t})}),t.Renderer.register("fillColor",function(){for(var t=void 0,e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return t=1===n.length?s["default"].hexToRGB(n[0]):n,new l["default"](function(){this.r=t[0],this.g=t[1],this.b=t[2],this.a=255})}),t.Renderer.register("saturation",function(t){return t*=-.01,new l["default"](function(){var e=Math.max(this.r,this.g,this.b);this.r!==e&&(this.r+=(e-this.r)*t),this.g!==e&&(this.g+=(e-this.g)*t),this.b!==e&&(this.b+=(e-this.b)*t)})}),t.Renderer.register("vibrance",function(t){return t*=-1,new l["default"](function(){var e=Math.max(this.r,this.g,this.b),n=(this.r+this.g+this.b)/3,i=2*Math.abs(e-n)/255*t/100;this.r!==e&&(this.r+=(e-this.r)*i),this.g!==e&&(this.g+=(e-this.g)*i),this.b!==e&&(this.b+=(e-this.b)*i)})}),t.Renderer.register("greyscale",function(t){return new l["default"](function(){this.r=this.g=this.b=a["default"].luminance(this.r,this.g,this.b)})}),t.Renderer.register("contrast",function(t){return t=Math.pow((t+100)/100,2),new l["default"](function(){this.r=255*((this.r/255-.5)*t+.5),this.g=255*((this.g/255-.5)*t+.5),this.b=255*((this.b/255-.5)*t+.5)})})}Object.defineProperty(e,"__esModule",{value:!0}),e.Filters=r;var o=n(7),a=i(o),u=n(8),s=i(u),c=n(4),l=i(c)},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(){n(this,t)}return i(t,null,[{key:"luminance",value:function(t,e,n){return.299*t+.587*e+.114*n}}]),t}();e["default"]=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(){n(this,t)}return i(t,null,[{key:"hexToRGB",value:function(t){return"#"==t.charAt(0)&&(t=t.substr(1)),[parseInt(t.substr(0,2),16),parseInt(t.substr(2,2),16),parseInt(t.substr(4,2),16)]}}]),t}();e["default"]=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t){}Object.defineProperty(e,"__esModule",{value:!0}),e.Convolution=r;var o=n(10);i(o)},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function r(){n(this,r)};e["default"]=i}])});
//# sourceMappingURL=caman.min.js.map
